2021-07-01 21:13:17.668177: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-01 21:14:33.194658: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-07-01 21:14:33.228125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 447.48GiB/s
2021-07-01 21:14:33.228216: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-01 21:14:33.270872: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-07-01 21:14:33.293203: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-07-01 21:14:33.302068: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-07-01 21:14:33.346221: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-07-01 21:14:33.354837: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-07-01 21:14:33.434730: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-07-01 21:14:33.443682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-07-01 21:14:33.447474: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-01 21:14:33.463362: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2599940000 Hz
2021-07-01 21:14:33.463479: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x3db5680 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-01 21:14:33.463498: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-01 21:14:33.573873: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x3d969f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-01 21:14:33.573945: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA TITAN X (Pascal), Compute Capability 6.1
2021-07-01 21:14:33.576422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 447.48GiB/s
2021-07-01 21:14:33.576460: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-01 21:14:33.576489: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-07-01 21:14:33.576507: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-07-01 21:14:33.576523: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-07-01 21:14:33.576538: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-07-01 21:14:33.576554: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-07-01 21:14:33.577249: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-07-01 21:14:33.578939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-07-01 21:14:33.580774: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-01 21:14:35.432074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-01 21:14:35.432151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-07-01 21:14:35.432163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-07-01 21:14:35.438059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11228 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:02:00.0, compute capability: 6.1)
2021-07-01 21:14:41.488800: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-07-01 21:14:44.211022: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
Using model index: 20
Making train data...
GCN...
ZCA...
Done!
Making test data...
Done!
Epoch 1/350


Snapshot weight 0 shuffle 2 at epoch 1
Layer 11
Getting activations...


391/391 - 25s - loss: 2.3158 - accuracy: 0.1202 - val_loss: 2.5363 - val_accuracy: 0.1145
Epoch 2/350


Snapshot weight 0 shuffle 2 at epoch 2
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3210 - accuracy: 0.1013 - val_loss: 2.3267 - val_accuracy: 0.1000
Epoch 3/350


Snapshot weight 0 shuffle 2 at epoch 3
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3267 - accuracy: 0.0991 - val_loss: 2.3267 - val_accuracy: 0.1000
Epoch 4/350


Snapshot weight 0 shuffle 2 at epoch 4
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3266 - accuracy: 0.0994 - val_loss: 2.3266 - val_accuracy: 0.1000
Epoch 5/350


Snapshot weight 0 shuffle 2 at epoch 5
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3266 - accuracy: 0.0998 - val_loss: 2.3266 - val_accuracy: 0.1000
Epoch 6/350


Snapshot weight 0 shuffle 2 at epoch 6
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3266 - accuracy: 0.0996 - val_loss: 2.3265 - val_accuracy: 0.1000
Epoch 7/350


Snapshot weight 0 shuffle 2 at epoch 7
Layer 11
Getting activations...


391/391 - 25s - loss: 2.3265 - accuracy: 0.0999 - val_loss: 2.3265 - val_accuracy: 0.1000
Epoch 8/350


Snapshot weight 0 shuffle 2 at epoch 8
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3265 - accuracy: 0.0999 - val_loss: 2.3265 - val_accuracy: 0.1000
Epoch 9/350


Snapshot weight 0 shuffle 2 at epoch 9
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3264 - accuracy: 0.1000 - val_loss: 2.3264 - val_accuracy: 0.1000
Epoch 10/350


Snapshot weight 0 shuffle 2 at epoch 10
Layer 11
Getting activations...


391/391 - 25s - loss: 2.3264 - accuracy: 0.1000 - val_loss: 2.3264 - val_accuracy: 0.1000
Epoch 11/350
391/391 - 24s - loss: 2.3264 - accuracy: 0.0999 - val_loss: 2.3264 - val_accuracy: 0.1000
Epoch 12/350
391/391 - 24s - loss: 2.3263 - accuracy: 0.0997 - val_loss: 2.3263 - val_accuracy: 0.1000
Epoch 13/350
391/391 - 24s - loss: 2.3263 - accuracy: 0.0999 - val_loss: 2.3263 - val_accuracy: 0.1000
Epoch 14/350
391/391 - 24s - loss: 2.3263 - accuracy: 0.0997 - val_loss: 2.3262 - val_accuracy: 0.1000
Epoch 15/350
391/391 - 24s - loss: 2.3262 - accuracy: 0.0999 - val_loss: 2.3262 - val_accuracy: 0.1000
Epoch 16/350
391/391 - 24s - loss: 2.3262 - accuracy: 0.0999 - val_loss: 2.3262 - val_accuracy: 0.1000
Epoch 17/350
391/391 - 24s - loss: 2.3262 - accuracy: 0.0999 - val_loss: 2.3261 - val_accuracy: 0.1000
Epoch 18/350
391/391 - 24s - loss: 2.3261 - accuracy: 0.0998 - val_loss: 2.3261 - val_accuracy: 0.1000
Epoch 19/350
391/391 - 24s - loss: 2.3261 - accuracy: 0.1000 - val_loss: 2.3261 - val_accuracy: 0.1000
Epoch 20/350
391/391 - 24s - loss: 2.3261 - accuracy: 0.0999 - val_loss: 2.3260 - val_accuracy: 0.1000
Epoch 21/350
391/391 - 24s - loss: 2.3260 - accuracy: 0.1000 - val_loss: 2.3260 - val_accuracy: 0.1000
Epoch 22/350
391/391 - 24s - loss: 2.3260 - accuracy: 0.1000 - val_loss: 2.3260 - val_accuracy: 0.1000
Epoch 23/350
391/391 - 24s - loss: 2.3259 - accuracy: 0.0999 - val_loss: 2.3259 - val_accuracy: 0.1000
Epoch 24/350
391/391 - 24s - loss: 2.3259 - accuracy: 0.1000 - val_loss: 2.3259 - val_accuracy: 0.1000
Epoch 25/350
391/391 - 24s - loss: 2.3259 - accuracy: 0.0999 - val_loss: 2.3258 - val_accuracy: 0.1000
Epoch 26/350
391/391 - 24s - loss: 2.3258 - accuracy: 0.0997 - val_loss: 2.3258 - val_accuracy: 0.1000
Epoch 27/350
391/391 - 24s - loss: 2.3258 - accuracy: 0.1004 - val_loss: 2.3258 - val_accuracy: 0.1000
Epoch 28/350
391/391 - 24s - loss: 2.3257 - accuracy: 0.1006 - val_loss: 2.3257 - val_accuracy: 0.1000
Epoch 29/350
391/391 - 24s - loss: 2.3257 - accuracy: 0.0999 - val_loss: 2.3257 - val_accuracy: 0.1000
Epoch 30/350
391/391 - 24s - loss: 2.3257 - accuracy: 0.0999 - val_loss: 2.3257 - val_accuracy: 0.1000
Epoch 31/350
391/391 - 24s - loss: 2.3256 - accuracy: 0.1000 - val_loss: 2.3256 - val_accuracy: 0.1000
Epoch 32/350
391/391 - 24s - loss: 2.3256 - accuracy: 0.1000 - val_loss: 2.3256 - val_accuracy: 0.1000
Epoch 33/350
391/391 - 24s - loss: 2.3256 - accuracy: 0.1000 - val_loss: 2.3256 - val_accuracy: 0.1000
Epoch 34/350
391/391 - 24s - loss: 2.3255 - accuracy: 0.1000 - val_loss: 2.3255 - val_accuracy: 0.1000
Epoch 35/350
391/391 - 25s - loss: 2.3255 - accuracy: 0.1000 - val_loss: 2.3255 - val_accuracy: 0.1000
Epoch 36/350
391/391 - 24s - loss: 2.3255 - accuracy: 0.1000 - val_loss: 2.3254 - val_accuracy: 0.1000
Epoch 37/350
391/391 - 24s - loss: 2.3254 - accuracy: 0.1000 - val_loss: 2.3254 - val_accuracy: 0.1000
Epoch 38/350
391/391 - 24s - loss: 2.3254 - accuracy: 0.1000 - val_loss: 2.3254 - val_accuracy: 0.1000
Epoch 39/350
391/391 - 24s - loss: 2.3254 - accuracy: 0.0999 - val_loss: 2.3253 - val_accuracy: 0.1000
Epoch 40/350
391/391 - 24s - loss: 2.3253 - accuracy: 0.1000 - val_loss: 2.3253 - val_accuracy: 0.1000
Epoch 41/350
391/391 - 24s - loss: 2.3253 - accuracy: 0.1000 - val_loss: 2.3253 - val_accuracy: 0.1000
Epoch 42/350
391/391 - 24s - loss: 2.3253 - accuracy: 0.0999 - val_loss: 2.3252 - val_accuracy: 0.1000
Epoch 43/350
391/391 - 24s - loss: 2.3252 - accuracy: 0.0999 - val_loss: 2.3252 - val_accuracy: 0.1000
Epoch 44/350
391/391 - 24s - loss: 2.3252 - accuracy: 0.1000 - val_loss: 2.3252 - val_accuracy: 0.1000
Epoch 45/350
391/391 - 24s - loss: 2.3251 - accuracy: 0.1000 - val_loss: 2.3251 - val_accuracy: 0.1000
Epoch 46/350
391/391 - 24s - loss: 2.3251 - accuracy: 0.1000 - val_loss: 2.3251 - val_accuracy: 0.1000
Epoch 47/350
391/391 - 24s - loss: 2.3251 - accuracy: 0.1000 - val_loss: 2.3251 - val_accuracy: 0.1000
Epoch 48/350
391/391 - 24s - loss: 2.3250 - accuracy: 0.1000 - val_loss: 2.3250 - val_accuracy: 0.1000
Epoch 49/350
391/391 - 24s - loss: 2.3250 - accuracy: 0.1000 - val_loss: 2.3250 - val_accuracy: 0.1000
Epoch 50/350


Snapshot weight 0 shuffle 2 at epoch 50
Layer 11
Getting activations...


391/391 - 24s - loss: 2.3250 - accuracy: 0.1000 - val_loss: 2.3250 - val_accuracy: 0.1000
Epoch 51/350
391/391 - 24s - loss: 2.3249 - accuracy: 0.1000 - val_loss: 2.3249 - val_accuracy: 0.1000
Epoch 52/350
391/391 - 24s - loss: 2.3249 - accuracy: 0.1000 - val_loss: 2.3249 - val_accuracy: 0.1000
Epoch 53/350
391/391 - 24s - loss: 2.3249 - accuracy: 0.1000 - val_loss: 2.3248 - val_accuracy: 0.1000
Epoch 54/350
391/391 - 24s - loss: 2.3248 - accuracy: 0.0999 - val_loss: 2.3248 - val_accuracy: 0.1000
Epoch 55/350
391/391 - 24s - loss: 2.3248 - accuracy: 0.1000 - val_loss: 2.3248 - val_accuracy: 0.1000
Epoch 56/350
391/391 - 24s - loss: 2.3248 - accuracy: 0.1000 - val_loss: 2.3247 - val_accuracy: 0.1000
Epoch 57/350
391/391 - 24s - loss: 2.3247 - accuracy: 0.1000 - val_loss: 2.3247 - val_accuracy: 0.1000
Epoch 58/350
391/391 - 24s - loss: 2.3247 - accuracy: 0.1000 - val_loss: 2.3247 - val_accuracy: 0.1000
Epoch 59/350
391/391 - 24s - loss: 2.3247 - accuracy: 0.1000 - val_loss: 2.3246 - val_accuracy: 0.1000
Epoch 60/350
391/391 - 24s - loss: 2.3246 - accuracy: 0.1000 - val_loss: 2.3246 - val_accuracy: 0.1000
Epoch 61/350
391/391 - 24s - loss: 2.3246 - accuracy: 0.1000 - val_loss: 2.3246 - val_accuracy: 0.1000
Epoch 62/350
391/391 - 24s - loss: 2.3245 - accuracy: 0.1000 - val_loss: 2.3245 - val_accuracy: 0.1000
Epoch 63/350
391/391 - 24s - loss: 2.3245 - accuracy: 0.1000 - val_loss: 2.3245 - val_accuracy: 0.1000
Epoch 64/350
391/391 - 24s - loss: 2.3245 - accuracy: 0.1000 - val_loss: 2.3245 - val_accuracy: 0.1000
Epoch 65/350
391/391 - 24s - loss: 2.3245 - accuracy: 0.1000 - val_loss: 2.3244 - val_accuracy: 0.1000
Epoch 66/350
391/391 - 24s - loss: 2.3244 - accuracy: 0.0999 - val_loss: 2.3244 - val_accuracy: 0.1000
Epoch 67/350
391/391 - 24s - loss: 2.3244 - accuracy: 0.1000 - val_loss: 2.3244 - val_accuracy: 0.1000
Epoch 68/350
391/391 - 24s - loss: 2.3243 - accuracy: 0.1000 - val_loss: 2.3243 - val_accuracy: 0.1000
Epoch 69/350
391/391 - 24s - loss: 2.3243 - accuracy: 0.0999 - val_loss: 2.3243 - val_accuracy: 0.1000
Epoch 70/350
391/391 - 24s - loss: 2.3243 - accuracy: 0.0999 - val_loss: 2.3243 - val_accuracy: 0.1000
Epoch 71/350
391/391 - 24s - loss: 2.3242 - accuracy: 0.0999 - val_loss: 2.3242 - val_accuracy: 0.1000
Epoch 72/350
391/391 - 24s - loss: 2.3242 - accuracy: 0.1001 - val_loss: 2.3242 - val_accuracy: 0.1000
Epoch 73/350
391/391 - 24s - loss: 2.3242 - accuracy: 0.1003 - val_loss: 2.3242 - val_accuracy: 0.1000
Epoch 74/350
391/391 - 24s - loss: 2.3239 - accuracy: 0.1020 - val_loss: 2.3241 - val_accuracy: 0.1023
Epoch 75/350
391/391 - 24s - loss: 2.3175 - accuracy: 0.1123 - val_loss: 2.3100 - val_accuracy: 0.1266
Epoch 76/350
391/391 - 24s - loss: 2.3099 - accuracy: 0.1192 - val_loss: 2.3057 - val_accuracy: 0.1247
Epoch 77/350
391/391 - 24s - loss: 2.3078 - accuracy: 0.1173 - val_loss: 2.3117 - val_accuracy: 0.1215
Epoch 78/350
391/391 - 24s - loss: 2.3049 - accuracy: 0.1139 - val_loss: 2.3017 - val_accuracy: 0.1206
Epoch 79/350
391/391 - 24s - loss: 2.3026 - accuracy: 0.1160 - val_loss: 2.2994 - val_accuracy: 0.1190
Epoch 80/350
391/391 - 24s - loss: 2.3003 - accuracy: 0.1168 - val_loss: 2.3053 - val_accuracy: 0.1220
Epoch 81/350
391/391 - 24s - loss: 2.2989 - accuracy: 0.1165 - val_loss: 2.2930 - val_accuracy: 0.1210
Epoch 82/350
391/391 - 24s - loss: 2.2950 - accuracy: 0.1173 - val_loss: 2.2887 - val_accuracy: 0.1231
Epoch 83/350
391/391 - 24s - loss: 2.2926 - accuracy: 0.1185 - val_loss: 2.2891 - val_accuracy: 0.1210
Epoch 84/350
391/391 - 24s - loss: 2.2901 - accuracy: 0.1206 - val_loss: 2.2896 - val_accuracy: 0.1266
Epoch 85/350
391/391 - 24s - loss: 2.2889 - accuracy: 0.1204 - val_loss: 2.2894 - val_accuracy: 0.1281
Epoch 86/350
391/391 - 24s - loss: 2.2863 - accuracy: 0.1239 - val_loss: 2.2826 - val_accuracy: 0.1263
Epoch 87/350
391/391 - 24s - loss: 2.2828 - accuracy: 0.1265 - val_loss: 2.2731 - val_accuracy: 0.1360
Epoch 88/350
391/391 - 24s - loss: 2.2722 - accuracy: 0.1406 - val_loss: 2.2555 - val_accuracy: 0.1463
Epoch 89/350
391/391 - 24s - loss: 2.2589 - accuracy: 0.1560 - val_loss: 2.2510 - val_accuracy: 0.1585
Epoch 90/350
391/391 - 25s - loss: 2.2579 - accuracy: 0.1530 - val_loss: 2.2738 - val_accuracy: 0.1419
Epoch 91/350
391/391 - 24s - loss: 2.1773 - accuracy: 0.2028 - val_loss: 2.0953 - val_accuracy: 0.2733
Epoch 92/350
391/391 - 24s - loss: 2.0826 - accuracy: 0.2697 - val_loss: 2.1154 - val_accuracy: 0.2742
Epoch 93/350
391/391 - 24s - loss: 1.8929 - accuracy: 0.3403 - val_loss: 1.8254 - val_accuracy: 0.3586
Epoch 94/350
391/391 - 24s - loss: 1.6443 - accuracy: 0.4187 - val_loss: 1.4715 - val_accuracy: 0.4826
Epoch 95/350
391/391 - 24s - loss: 1.4440 - accuracy: 0.4897 - val_loss: 1.3145 - val_accuracy: 0.5466
Epoch 96/350
391/391 - 25s - loss: 1.2647 - accuracy: 0.5555 - val_loss: 1.1524 - val_accuracy: 0.5961
Epoch 97/350
391/391 - 24s - loss: 1.1764 - accuracy: 0.5895 - val_loss: 1.0491 - val_accuracy: 0.6329
Epoch 98/350
391/391 - 24s - loss: 1.0934 - accuracy: 0.6152 - val_loss: 0.9609 - val_accuracy: 0.6692
Epoch 99/350
391/391 - 24s - loss: 1.0406 - accuracy: 0.6390 - val_loss: 1.0709 - val_accuracy: 0.6448
Epoch 100/350


Snapshot weight 0 shuffle 2 at epoch 100
Layer 11
Getting activations...


391/391 - 25s - loss: 0.9830 - accuracy: 0.6619 - val_loss: 0.9219 - val_accuracy: 0.6817
Epoch 101/350
391/391 - 24s - loss: 0.9481 - accuracy: 0.6711 - val_loss: 0.8195 - val_accuracy: 0.7189
Epoch 102/350
Acc: 0.690500020980835
391/391 - 24s - loss: 0.8996 - accuracy: 0.6905 - val_loss: 0.9468 - val_accuracy: 0.6828
/usr/local/lib/python3.6/dist-packages/tensorflow/python/autograph/impl/api.py:493: UserWarning: fill_value is not supported and is always 0 for TensorFlow < 2.4.0.
  return py_builtins.overload_of(f)(*args)
Traceback (most recent call last):
  File "../python_scripts/train.py", line 443, in <module>
    raise ValueException(
NameError: name 'ValueException' is not defined
